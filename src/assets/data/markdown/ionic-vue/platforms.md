# Lab: Add Capacitor Platforms

In this lab, you will:

- Update the Capacitor configuration
- Add the iOS and Android platforms
- Update the splash screen and application icon
- Build and run the application on both platforms

## Update the Configuration

When a Capacitor platform is added or updated, information in the `capacitor.config.ts` file is used to generate some of the project files. Some of this information should be changed up front:

- The `appId` should be change to something unique like `com.foobar.teataster` (only use your own name or company domain, not this generic domain... ðŸ¤“)
- The `appName` should be checked to ensure it is correct

Here is an example of those changes:

**Before:**

```typescript
import { CapacitorConfig } from '@capacitor/cli';

const config: CapacitorConfig = {
  appId: 'io.ionic.starter',
  appName: 'tea-taster',
  webDir: 'dist',
  bundledWebRuntime: false,
};

export default config;
```

**After:**

```typescript
import { CapacitorConfig } from '@capacitor/cli';

const config: CapacitorConfig = {
  appId: 'com.yournamehere.teataster',
  appName: 'Tea Taster',
  webDir: 'dist',
  bundledWebRuntime: false,
};

export default config;
```

In our case, the `appId` required a change in order to make it globally unique. I also decided to change the application name. This is the name displayed under the icon when installed on your device. In either case, they can be changed after the platforms are generated by updating this file _and_ the native projects, but it is easiest to do now before the native projects have been created.

Make similar changes to your application.

## Add the Android and iOS Platforms

Before adding any Capacitor platforms, you need to make sure that your application has been built. If it has not been built, the `dist` directory will not exist and adding the platforms will not be as smooth.

```bash
npm run build
```

Now you can add both the Android and iOS platforms.

```bash
ionic cap add android
ionic cap add ios
```

Once the platforms are added, open the native projects, each in their own IDE.

```bash
ionic cap open android
ionic cap open ios
```

**Note:** you need to have Android Studio installed if you want to build on Android. You need to be using a Mac that has Xcode properly installed in order to build for iOS.

## Update the Splash Screen and Application Icon

Capacitor has a tool called <a href="https://www.npmjs.com/package/@capacitor/assets" target="_blank">`@capacitor/assets`</a> that creates all of the icons that the native applications need. This tool will also generate the icons that are needed if we decide to deploy our application as a PWA.

In order to use this tool, we need to install it as a dev dependency:

```bash
npm i -D @capacitor/assets
```

Next, get the source image files that we need. Note that this is just our "product logo" in two versions, one for light mode and one for dark mode. Dark mode is optional.

- create a `resources` directory at the root level of the application (`mkdir resources`)
- download the following images to the newly created `resources` directory
  - <a download href="/assets/packages/ionic-vue/logo.png">logo.png</a>
  - <a download href="/assets/packages/ionic-vue/logo-dark.png">logo-dark.png</a>

To generate the required resources and copy them to the native projects, use the following command:

```bash
npx capacitor-assets generate --iconBackgroundColor '#f1ebe1' --splashBackgroundColor '#f1ebe1' --iconBackgroundColorDark '#110b00' --splashBackgroundColorDark '#110b00'
```

## Live Reload (Optional)

Now that the projects are set up and building properly, you can use Ionic's "live reload" feature if you would like to. This feature allows you to run the application on your device and then rebuild and reload the application on your device as you develop. This is similar to `ionic serve` but is running the application on your device(s) instead of the browser.

```bash
ionic cap run android --livereload --external
ionic cap run ios --livereload --external
```

These commands start a dev server that monitors changes to the Ionic project, launches the proper IDE, and allows you to run the application on a device. Once that is done, then when you change the Ionic application, it will be rebuilt and reloaded on the device(s).

## Update NPM Scripts (Optional)

I like to have my build do a copy for me. For this reason, I do a `cap copy` with every build. This ensures my native projects are always up to date.

```JSON
  "scripts": {
    "build": "vue-cli-service build && cap copy",
    "lint": "vue-cli-service lint",
    "prepare": "husky install",
    "serve": "vue-cli-service serve",
    "test:dev": "vue-cli-service test:unit --watch",
    "test:unit": "vue-cli-service test:unit",
    "test:e2e": "vue-cli-service test:e2e"
  },
```

## Conclusion

In this lab we learned how to add iOS and Android platforms and how to build the application for those platforms.
